---
title: "Paper figures"
author: "Rodrigo Taketani"
date: "`r Sys.Date()`"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, dpi = 300)
```

# Paper figures

This is a document for the creation of figures for the paper

## Load data

Load objects generated by other scripts

```{r}

# Load the data
load("uncult_metabarcode_figs.RData")
load("isolate_metabarcode_figs.RData")
load("funct_figs.RData")


```

# Make figures
## Beta diversity NMDS

```{r, fig.width=10, fig.height=10}
 library(patchwork)
library(ggplot2)
library(scales)

nmds_plot_comb_uncult / nmds_plot_comb_isolates / nmds_func + plot_annotation(tag_levels = 'A') &
  theme(plot.tag = element_text(size = 14, face = "bold", hjust = 1, vjust = -1), 
    plot.tag.position = c(0, 1),
    plot.margin = margin(20, 20, 20, 20))


```
## Alpha diversity

```{r, fig.width=9, fig.height=7}

alpha_combined_plot_uncult / alpha_shannon_isolates + plot_annotation(tag_levels = 'A') &
  theme(plot.tag = element_text(size = 14, face = "bold"))

```




## Functions
```{r, fig.width=10.5, fig.height=11}

# First row
pA <- cluster_list_box_crops[[4]] #+ labs(title = NULL)
pB <- cluster_list_box_locations[[4]] # + labs(title = NULL)
pC <- cluster_list_box_soils[[4]] #+ labs(title = NULL)

# Second row
pD <- cluster_list_box_crops[[7]] #+ labs(title = NULL)
pE <- cluster_list_box_locations[[7]]# + labs(title = NULL)
pF <- cluster_list_box_soils[[7]] #+ labs(title = NULL)

# Third row
pG <- cluster_list_box_crops[[8]] #+ labs(title = NULL)
pH <- cluster_list_box_locations[[8]] #+ labs(title = NULL)
pI <- cluster_list_box_soils[[8]] #+ labs(title = NULL)

library(patchwork)

# Combine using patchwork
layout <- (pA + pB + pC) /
          (pD + pE + pF) /
          (pG + pH + pI) +
          plot_annotation(tag_levels = 'A') &
  theme(plot.tag = element_text(size = 14, face = "bold"))  # Automatically tags Aâ€“I

layout
```

